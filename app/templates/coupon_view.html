{% extends 'layout/main_view.html' %}

{% block column_left %}
<div class="sub-header border-radius__top">XEM PHIẾU MƯỢN PHÒNG</div>
<div id="coupon_view-container">
    <div class="flex-end col-header">
        <button class="btn-book_room" onclick="location.href='/dat_phong'"><i class="fa-solid fa-school icon"></i>Đặt phòng</button>
        <button class="btn-book_room btn-book_room--chosen" onclick="location.href='/xem_phieu_muon'"><i class="fa-solid fa-list-check icon"></i>Xem phiếu mượn</button>
    </div>

    <div class="accordion__container">
        <div class="accordion" collapsible="true">
            <div class="accordion__title" id="cho_duyet">
                <span>Đang chờ duyệt</span>
                <svg width="17" height="17">
                    <g fill-rule="nonzero" stroke="#0078C1" stroke-width="3" fill="none" stroke-linecap="square">
                        <path d="M14.664 8.5H1.5M8 15.164V2"></path>
                    </g>
                </svg>
            </div>
            <div class="accordion__content">
                <div class="coupon_wrapper">
                    {% for p in phieu_cho_duyet %}
                    <div class="coupon-detail">
                        <div class="coupon-title">MÃ PHIẾU MƯỢN <span class="important">#{{ p[10] }}</span> PHÒNG <span class="important">#{{ p[4] }}</span></div>
                        <div class="coupon-row">
                            <div class="coupon-col">
                                <div class="user-inform">
                                    <div class="coupon-detail__row">
                                        <div class="inform-detail__col">
                                            <div class="inform-detail_title">Họ tên người đặt phòng:</div>
                                            <div><input readonly value="{{ p[0] }}" class="detail-input" type="text"></div>
                                        </div>
                                        <div class="inform-detail__col">
                                            <div class="inform-detail_title">Tổ chức đại diện:</div>
                                            <div><input readonly value="{{ p[1] }}" class="detail-input" type="text"></div>
                                        </div>
                                    </div>
                                    <div class="coupon-detail__row">
                                        <div class="inform-detail__col">
                                            <div class="inform-detail_title">Số điện thoại: </div>
                                            <div><input readonly value = '{{ p[3] }}' class="detail-input" type="text"></div>
                                        </div>
                                        <div class="inform-detail__col">
                                            <div class="inform-detail_title">Mã số sinh viên: </div>
                                            <div><input readonly value = '{{ p[2] }}' class="detail-input" type="text"></div>
                                        </div>
                                    </div>
                                    <div class="coupon-detail__row">
                                        <div class="inform-detail__col">
                                            <div class="inform-detail_title">Thời gian ghi nhận:</div>
                                            <div><input readonly value="{{ p[9] }}" class="detail-input" type="datetime-local"></div>
                                        </div>
                                    </div>
                                    <div class="coupon-detail__row">
                                        <div class="inform-detail__col">
                                            <div class="inform-detail_title">Ngày nhận phòng: </div>
                                            <div><input readonly value="{{ p[7] }}" class="detail-input" type="date"></div>
                                        </div>
                                        <div class="inform-detail__col">
                                            <div class="inform-detail_title">Giờ bắt đầu: </div>
                                            <div><input readonly value = '{{ p[5] }}' class="detail-input" type="time"></div>
                                        </div>
                                        <div class="inform-detail__col">
                                            <div class="inform-detail_title">Giờ kết thúc: </div>
                                            <div><input readonly value = '{{ p[6] }}' class="detail-input" type="time"></div>
                                        </div>
                                    </div>
                                    <div class="coupon-detail__row ">
                                        <div class="inform-detail__col full-width">
                                           <div class="inform-detail_title">Lý do: </div>
                                            <div><input readonly value = '{{ p[8] }}' class="detail-input full-width" type="text"></div>
                                        </div>
                                    </div>


<!--                                    <div class="coupon-detail__row">-->
<!--                                        <div class="inform-detail__col">-->
<!--                                            <button>fasdf</button>-->
<!--                                        </div>-->
<!--                                    </div>-->
                                </div>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
        <div class="accordion" collapsible="true">
            <div class="accordion__title">
                <span>Bị từ chối</span>
                <svg width="17" height="17">
                    <g fill-rule="nonzero" stroke="#0078C1" stroke-width="3" fill="none" stroke-linecap="square">
                        <path d="M14.664 8.5H1.5M8 15.164V2"></path>
                    </g>
                </svg>
            </div>
            <div class="accordion__content">
                <div class="coupon_wrapper">
                    {% for p in phieu_tu_choi %}
                    <div class="coupon-detail">
                        <div class="coupon-title">MÃ PHIẾU MƯỢN <span class="important">#{{ p[10] }}</span> PHÒNG <span class="important">#{{ p[4] }}</span></div>
                        <div class="coupon-row">
                            <div class="coupon-col">
                                <div class="user-inform">
                                    <div class="coupon-detail__row">
                                        <div class="inform-detail__col">
                                            <div class="inform-detail_title">Họ tên người đặt phòng:</div>
                                            <div><input readonly value="{{ p[0] }}" class="detail-input" type="text"></div>
                                        </div>
                                        <div class="inform-detail__col">
                                            <div class="inform-detail_title">Tổ chức đại diện:</div>
                                            <div><input readonly value="{{ p[1] }}" class="detail-input" type="text"></div>
                                        </div>
                                    </div>
                                    <div class="coupon-detail__row">
                                        <div class="inform-detail__col">
                                            <div class="inform-detail_title">Số điện thoại: </div>
                                            <div><input readonly value = '{{ p[3] }}' class="detail-input" type="text"></div>
                                        </div>
                                        <div class="inform-detail__col">
                                            <div class="inform-detail_title">Mã số sinh viên: </div>
                                            <div><input readonly value = '{{ p[2] }}' class="detail-input" type="text"></div>
                                        </div>
                                    </div>
                                    <div class="coupon-detail__row">
                                        <div class="inform-detail__col">
                                            <div class="inform-detail_title">Thời gian ghi nhận:</div>
                                            <div><input readonly value="{{ p[9] }}" class="detail-input" type="datetime-local"></div>
                                        </div>
                                    </div>
                                    <div class="coupon-detail__row">
                                        <div class="inform-detail__col">
                                            <div class="inform-detail_title">Ngày nhận phòng: </div>
                                            <div><input readonly value="{{ p[7] }}" class="detail-input" type="date"></div>
                                        </div>
                                        <div class="inform-detail__col">
                                            <div class="inform-detail_title">Giờ bắt đầu: </div>
                                            <div><input readonly value = '{{ p[5] }}' class="detail-input" type="time"></div>
                                        </div>
                                        <div class="inform-detail__col">
                                            <div class="inform-detail_title">Giờ kết thúc: </div>
                                            <div><input readonly value = '{{ p[6] }}' class="detail-input" type="time"></div>
                                        </div>
                                    </div>
                                    <div class="coupon-detail__row ">
                                        <div class="inform-detail__col full-width">
                                           <div class="inform-detail_title">Lý do: </div>
                                            <div><input readonly value = '{{ p[8] }}' class="detail-input full-width" type="text"></div>
                                        </div>
                                    </div>


<!--                                    <div class="coupon-detail__row">-->
<!--                                        <div class="inform-detail__col">-->
<!--                                            <button>fasdf</button>-->
<!--                                        </div>-->
<!--                                    </div>-->
                                </div>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
        <div class="accordion" collapsible="true">
            <div class="accordion__title">
                <span>Đang sẵn sàng</span>
                <svg width="17" height="17">
                    <g fill-rule="nonzero" stroke="#0078C1" stroke-width="3" fill="none" stroke-linecap="square">
                        <path d="M14.664 8.5H1.5M8 15.164V2"></path>
                    </g>
                </svg>
            </div>
            <div class="accordion__content">
                <div class="coupon_wrapper">
                    {% for p in phieu_san_sang %}
                    <div class="coupon-detail">
                        <div class="coupon-title">MÃ PHIẾU MƯỢN <span class="important">#{{ p[10] }}</span> PHÒNG <span class="important">#{{ p[4] }}</span></div>
                        <div class="coupon-row">
                            <div class="coupon-col">
                                <div class="user-inform">
                                    <div class="coupon-detail__row">
                                        <div class="inform-detail__col">
                                            <div class="inform-detail_title">Họ tên người đặt phòng:</div>
                                            <div><input readonly value="{{ p[0] }}" class="detail-input" type="text"></div>
                                        </div>
                                        <div class="inform-detail__col">
                                            <div class="inform-detail_title">Tổ chức đại diện:</div>
                                            <div><input readonly value="{{ p[1] }}" class="detail-input" type="text"></div>
                                        </div>
                                    </div>
                                    <div class="coupon-detail__row">
                                        <div class="inform-detail__col">
                                            <div class="inform-detail_title">Số điện thoại: </div>
                                            <div><input readonly value = '{{ p[3] }}' class="detail-input" type="text"></div>
                                        </div>
                                        <div class="inform-detail__col">
                                            <div class="inform-detail_title">Mã số sinh viên: </div>
                                            <div><input readonly value = '{{ p[2] }}' class="detail-input" type="text"></div>
                                        </div>
                                    </div>
                                    <div class="coupon-detail__row">
                                        <div class="inform-detail__col">
                                            <div class="inform-detail_title">Thời gian ghi nhận:</div>
                                            <div><input readonly value="{{ p[9] }}" class="detail-input" type="datetime-local"></div>
                                        </div>
                                    </div>
                                    <div class="coupon-detail__row">
                                        <div class="inform-detail__col">
                                            <div class="inform-detail_title">Ngày nhận phòng: </div>
                                            <div><input readonly value="{{ p[7] }}" class="detail-input" type="date"></div>
                                        </div>
                                        <div class="inform-detail__col">
                                            <div class="inform-detail_title">Giờ bắt đầu: </div>
                                            <div><input readonly value = '{{ p[5] }}' class="detail-input" type="time"></div>
                                        </div>
                                        <div class="inform-detail__col">
                                            <div class="inform-detail_title">Giờ kết thúc: </div>
                                            <div><input readonly value = '{{ p[6] }}' class="detail-input" type="time"></div>
                                        </div>
                                    </div>
                                    <div class="coupon-detail__row ">
                                        <div class="inform-detail__col full-width">
                                           <div class="inform-detail_title">Lý do: </div>
                                            <div><input readonly value = '{{ p[8] }}' class="detail-input full-width" type="text"></div>
                                        </div>
                                    </div>


<!--                                    <div class="coupon-detail__row">-->
<!--                                        <div class="inform-detail__col">-->
<!--                                            <button>fasdf</button>-->
<!--                                        </div>-->
<!--                                    </div>-->
                                </div>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
        <div class="accordion" collapsible="true">
            <div class="accordion__title">
                <span>Đã hoàn thành</span>
                <svg width="17" height="17">
                    <g fill-rule="nonzero" stroke="#0078C1" stroke-width="3" fill="none" stroke-linecap="square">
                        <path d="M14.664 8.5H1.5M8 15.164V2"></path>
                    </g>
                </svg>
            </div>
            <div class="accordion__content">
                <div class="coupon_wrapper">
                    {% for p in phieu_thanh_cong %}
                    <div class="coupon-detail">
                        <div class="coupon-title">MÃ PHIẾU MƯỢN <span class="important">#{{ p[10] }}</span> PHÒNG <span class="important">#{{ p[4] }}</span></div>
                        <div class="coupon-row">
                            <div class="coupon-col">
                                <div class="user-inform">
                                    <div class="coupon-detail__row">
                                        <div class="inform-detail__col">
                                            <div class="inform-detail_title">Họ tên người đặt phòng:</div>
                                            <div><input readonly value="{{ p[0] }}" class="detail-input" type="text"></div>
                                        </div>
                                        <div class="inform-detail__col">
                                            <div class="inform-detail_title">Tổ chức đại diện:</div>
                                            <div><input readonly value="{{ p[1] }}" class="detail-input" type="text"></div>
                                        </div>
                                    </div>
                                    <div class="coupon-detail__row">
                                        <div class="inform-detail__col">
                                            <div class="inform-detail_title">Số điện thoại: </div>
                                            <div><input readonly value = '{{ p[3] }}' class="detail-input" type="text"></div>
                                        </div>
                                        <div class="inform-detail__col">
                                            <div class="inform-detail_title">Mã số sinh viên: </div>
                                            <div><input readonly value = '{{ p[2] }}' class="detail-input" type="text"></div>
                                        </div>
                                    </div>
                                    <div class="coupon-detail__row">
                                        <div class="inform-detail__col">
                                            <div class="inform-detail_title">Thời gian ghi nhận:</div>
                                            <div><input readonly value="{{ p[9] }}" class="detail-input" type="datetime-local"></div>
                                        </div>
                                    </div>
                                    <div class="coupon-detail__row">
                                        <div class="inform-detail__col">
                                            <div class="inform-detail_title">Ngày nhận phòng: </div>
                                            <div><input readonly value="{{ p[7] }}" class="detail-input" type="date"></div>
                                        </div>
                                        <div class="inform-detail__col">
                                            <div class="inform-detail_title">Giờ bắt đầu: </div>
                                            <div><input readonly value = '{{ p[5] }}' class="detail-input" type="time"></div>
                                        </div>
                                        <div class="inform-detail__col">
                                            <div class="inform-detail_title">Giờ kết thúc: </div>
                                            <div><input readonly value = '{{ p[6] }}' class="detail-input" type="time"></div>
                                        </div>
                                    </div>
                                    <div class="coupon-detail__row ">
                                        <div class="inform-detail__col full-width">
                                           <div class="inform-detail_title">Lý do: </div>
                                            <div><input readonly value = '{{ p[8] }}' class="detail-input full-width" type="text"></div>
                                        </div>
                                    </div>


<!--                                    <div class="coupon-detail__row">-->
<!--                                        <div class="inform-detail__col">-->
<!--                                            <button>fasdf</button>-->
<!--                                        </div>-->
<!--                                    </div>-->
                                </div>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
</div>

{% block api %}
<script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.js"></script>
<script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.ui.min.js"></script>
<script>
    var velocity = window.Velocity || $.Velocity,
    accordions = document.querySelectorAll('.accordion'),
    animationDuration = 500,

    closeAccordion = (clickedAccordion) => {
        clickedAccordion.classList.remove('accordion--open');
        velocity(clickedAccordion.querySelector('svg'), {rotateZ: 0}, {duration: animationDuration, easing: 'easeInQuad'});
        velocity(clickedAccordion.querySelector('.accordion__content'), 'slideUp', {duration: animationDuration, easing: 'easeInQuad'});
    },

    openAccordion = (clickedAccordion) => {
        clickedAccordion.classList.add('accordion--open');
        velocity(clickedAccordion.querySelector('svg'), {rotateZ: '135deg'}, {duration: animationDuration, easing: 'easeOutQuad'});
        velocity(clickedAccordion.querySelector('.accordion__content'), 'slideDown', {duration: animationDuration, easing: 'easeOutQuad'});
    },

    isCollapsible = (accordion) => {
        return accordion.getAttribute('collapsible') === 'true';
    },

    checkCollapse = (event) => {
        let clickedAccordion = event.currentTarget.closest('.accordion');
        if (clickedAccordion) {
            let groupedAccordions = [].slice.call(clickedAccordion.closest('.accordion__container').querySelectorAll('.accordion'));
            groupedAccordions.every(isCollapsible) ? updateCollapseStatus(clickedAccordion) : updateOpenStatus(clickedAccordion);
        }
    },

    updateCollapseStatus = clickedAccordion => {
        clickedAccordion.classList.contains('accordion--open') ? closeAccordion(clickedAccordion) : openAccordion(clickedAccordion);
    },

    updateOpenStatus = clickedAccordion => {
        if (!clickedAccordion.classList.contains('accordion--open')) {
            [].forEach.call(clickedAccordion.closest('.accordion__container').querySelectorAll('.accordion'), accordion => {
                closeAccordion(accordion);
            });

            openAccordion(clickedAccordion);
        };
    },
    init = () => {
        [].forEach.call(accordions, accordion => {
            accordion.querySelector('.accordion__title').addEventListener('click', checkCollapse);
        });

        // Open first accordion for non collapsible accordions on page load
        [].forEach.call(document.querySelectorAll('.accordion__container'), accordionContainers => {
            let allAccords = [].slice.call(accordionContainers.querySelectorAll('.accordion')),
                firstAccord = allAccords[0];

            if (!allAccords.every(isCollapsible)) {
                firstAccord.classList.add('accordion--open');
                velocity(firstAccord.querySelector('svg'), {rotateZ: '135deg'}, {duration: 0});
                velocity(firstAccord.querySelector('.accordion__content'), 'slideDown', {duration: 0});
            }
        });
    };

document.addEventListener('DOMContentLoaded', init);

window.onload = function() {
    document.getElementById("cho_duyet").click();
};


</script>
{% endblock %}
{% endblock %}